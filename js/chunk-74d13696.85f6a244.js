(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74d13696"],{"1a3d":function(e,t,s){"use strict";s.r(t);var a,r,n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:e.$t("message.receiveBox"),name:"1"}},[s("receive-box")],1),s("el-tab-pane",{attrs:{label:e.$t("message.sendMsg"),name:"3"}},[s("send-message")],1)],1)],1)},i=[],l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("user-table",{staticClass:"table1",staticStyle:{"overflow-y":"auto"},attrs:{tablehade:e.tableHade,showCheckbox:!0},on:{"check-all":e.checkAll}},[e._l(e.messageList,(function(t,a){return s("li",{key:a},[s("div",{staticStyle:{width:"50px"}},[s("p",[s("el-checkbox",{model:{value:t.checked,callback:function(s){e.$set(t,"checked",s)},expression:"item.checked"}})],1)]),s("div",[s("p",[e._v(" "+e._s(t.sender)+" ")])]),s("div",[s("p",[e._v(" "+e._s(t.msg_title)+" ")])]),s("div",[s("p",[e._v(" "+e._s(t.type)+" ")])]),s("div",{staticStyle:{width:"150px"}},[s("p",[e._v(" "+e._s(t.created_at)+" ")])]),s("div",[s("p",[e._v(" "+e._s(t.is_readed_name)+" ")])]),s("div",[s("p",[s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.deleteMessage(t.id)}}},[e._v(e._s(e.$t("message.delete")))]),0===t.is_readed?s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.readMessage(t.id)}}},[e._v(e._s(e.$t("message.read")))]):e._e()],1)])])})),s("li",{directives:[{name:"show",rawName:"v-show",value:0===e.messageList.length,expression:"messageList.length === 0"}]},[s("span",{staticClass:"nomsg"},[e._v(e._s(e.$t("gameRecord.noData")))])])],2),s("pagination",{attrs:{pageDate:e.pageDate},on:{jump:e.getRecord}})],1)},o=[],c=(s("4160"),s("d81d"),s("159b"),s("dc9d")),m=s("54f0"),g=s("4abb"),p=(s("56d7"),{name:"receive-box",components:{UserTable:m["a"],Pagination:g["a"]},data:function(){return{tableHade:[{title:this.$t("message.sender")},{title:this.$t("message.title")},{title:this.$t("message.type")},{title:this.$t("message.time"),width:"150px"},{title:this.$t("message.status")},{title:this.$t("message.oparation")}],pageDate:{page:1,pageSize:11,pageCount:0,totalCount:0},messageList:[]}},methods:{getRecord:function(e){var t=this;Object(c["e"])(e,this.pageDate.pageSize).then((function(e){if(0===e.errno){var s=e.data,a=s.page_count,r=s.total_count,n=s.data;t.messageList=n.map((function(e){return e.checked=!1,e.is_readed_name=0===e.is_readed?t.$t("message.unread"):t.$t("message.readed"),e})),t.pageDate.pageCount=a,t.pageDate.totalCount=r}}))},checkAll:function(e){this.messageList.forEach((function(t){t.checked=e}))},deleteMessage:function(e){var t=this;Object(c["b"])(e).then((function(e){0===e.errno?(t.$message({type:"info",message:t.$t("message.deleteMessageSuccess")}),t.getRecord(t.pageDate.page)):t.$message({type:"error",message:e.message})}))},readMessage:function(e){var t=this;Object(c["i"])(e).then((function(e){if(0===e.errno){var s=e.data,a=s.msg_title,r=s.content;t.$message_box.alert(r,a),t.getRecord(t.pageDate.page)}else t.$message({type:"error",message:e.message})}))}},created:function(){this.getRecord(1)}}),u=p,d=s("2877"),f=Object(d["a"])(u,l,o,!1,null,null,null),v=f.exports,h={},b=Object(d["a"])(h,a,r,!1,null,null,null),y=b.exports,$=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-form",{ref:"form",staticClass:"send-message-form",attrs:{model:e.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:e.$t("message.sender"),rules:[{required:!0,message:e.$t("message.receiverTypeIsEmpty"),trigger:"blur"}],prop:"messageType"}},[s("el-select",{attrs:{placeholder:e.$t("message.receiverTypeIsEmpty")},model:{value:e.form.messageType,callback:function(t){e.$set(e.form,"messageType",t)},expression:"form.messageType"}},e._l(e.messageType,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3===e.form.messageType,expression:"form.messageType === 3"}],attrs:{label:e.$t("message.sender"),rules:[{required:3===e.form.messageType,message:e.$t("message.receiverIsEmpty"),trigger:"blur"}],prop:"receivers"}},[s("el-select",{attrs:{filterable:"",placeholder:e.$t("message.receiverIsEmpty")},model:{value:e.form.receivers,callback:function(t){e.$set(e.form,"receivers",t)},expression:"form.receivers"}},e._l(e.childLevel,(function(t,a){return s("el-option-group",{key:a,attrs:{label:t.line}},e._l(t.users,(function(e,t){return s("el-option",{key:t,attrs:{label:e.username,value:e.id}})})),1)})),1)],1),s("el-form-item",{attrs:{label:e.$t("message.title"),rules:[{required:!0,message:e.$t("message.messageTitleIsEmpty"),trigger:"blur"}],prop:"title"}},[s("el-input",{attrs:{placeholder:e.$t("message.messageTitleIsEmpty")},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),s("el-form-item",{attrs:{label:e.$t("message.content"),rules:[{required:!0,message:e.$t("message.messageContentIsEmpty"),trigger:"blur"}],prop:"content"}},[s("el-input",{attrs:{type:"textarea",rows:"5",placeholder:e.$t("message.messageContentIsEmpty")},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),s("el-form-item",[s("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v(e._s(e.$t("common.resetForm")))]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sendMessage("form")}}},[e._v(e._s(e.$t("message.sendMsg")))])],1)],1)],1)},_=[],k={name:"send-message",data:function(){return{messageType:[],childLevel:[],parent:{},form:{messageType:0,receivers:"",title:"",content:""}}},methods:{getMessageType:function(){var e=this;Object(c["g"])().then((function(t){if(0===t.errno){var s=t.data,a=s.send_type,r=s.children;s.parent;e.messageType=a,e.childLevel=r,e.messageType.length>0&&(e.form.messageType=e.messageType[0].id)}}))},resetForm:function(e){this.$refs[e].resetFields(),this.messageType.length>0&&(this.form.messageType=this.messageType[0].id)},sendMessage:function(e){var t=this;this.$refs[e].validate((function(s){if(s){var a=t.parent&&t.parent.id||0,r=t.form.receivers;Object(c["h"])(t.form.messageType,a,r,t.form.title,t.form.content).then((function(s){0===s.errno?(t.$message({type:"success",message:t.$t("message.sendMessageSuccess")}),t.resetForm(e)):t.$message({type:"error",message:s.message})}))}}))}},created:function(){this.getMessageType()}},x=k,T=(s("3cf9"),Object(d["a"])(x,$,_,!1,null,null,null)),w=T.exports,M={name:"userMessages",components:{ReceiveBox:v,SentBox:y,SendMessage:w},data:function(){return{activeName:"1"}}},E=M,j=Object(d["a"])(E,n,i,!1,null,null,null);t["default"]=j.exports},"3cf9":function(e,t,s){"use strict";var a=s("c4fe"),r=s.n(a);r.a},c4fe:function(e,t,s){}}]);